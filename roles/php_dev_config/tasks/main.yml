- name: set php config options
  become: true
  ini_file:
    path: "/etc/php/{{ item[0] }}/{{ item[1] }}/php.ini"
    create: no
    section: '{{ item[2].section }}'
    option:  '{{ item[2].option }}'
    value:   '{{ item[2].value }}'
  with_nested:
    - [ 7.2 ]
    - [ cli, fpm ]
    -
      - { section: PHP,       option: error_reporting,         value: E_ALL }
      - { section: PHP,       option: display_errors,          value: On }
      - { section: PHP,       option: display_startup_errors,  value: On }
      - { section: PHP,       option: upload_max_filesize,     value: 20M }
      - { section: PHP,       option: post_max_size,           value: 20M }
      - { section: Session,   option: session.save_path,       value: '"0;660;/var/lib/php/sessions"' }
      - { section: Session,   option: session.gc_maxlifetime,  value: '86400' }
      - { section: Session,   option: session.cookie_lifetime, value: '86400' }
      - { section: Assertion, option: zend.assertions,         value: 1 }
  notify:
    - restart-php-fpm
